{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viva Mais+</title>
    <link rel="stylesheet" href="{% static 'health_ai/css/styles.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Título principal -->
        <h1 class="title">Viva Mais+</h1>
        <!-- Layout dividido: Resultados à esquerda, Chat à direita -->
        <div class="split-container">
            <!-- Análises Arquivadas -->
            <div class="results-section">
                <h2 class="results-title">Análises Arquivadas</h2>
                <div class="results-list" id="resultsList"></div>
            </div>

            <!-- Área principal: Chat -->
            <div class="chat-section">
                <!-- Círculo com DNA animado -->
                <div class="circle-container">
                    <div class="dna-container">
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                        <div class="dna-helix"></div>
                    </div>
                </div>

                <!-- Área de conversa -->
                <div class="chat-box">
                    <div class="messages" id="messages"></div>
                </div>
                <!-- Upload de arquivo e caixa de texto -->
                <div class="message-box">
                    <form id="novaMensagem" method="POST" action="/chat/">
                        {% csrf_token %}
                        <textarea placeholder="Escreva sua mensagem aqui..." class="message-input" id="userInput" name="userInput"></textarea>
                            <script>
                                document.getElementById('userInput').addEventListener('keydown', event => {
                                    if (event.key === 'Enter') {
                                        var message = document.getElementById('userInput').value;
                                        if (message != "") {
                                            console.log("Mensagem enviada:", message);
                                        } else {
                                            console.log("Nenhuma mensagem enviada");
                                        }   
                                    
                                try {
                                    var response = fetch('/VivaMais/chat/', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json',
                                        },
                                        body: JSON.stringify({ message }),
                                    });
                                } catch (e) {
                                    console.error("Erro ao enviar mensagem:", e);
                                }
                                }
                            });
                        </script>
                    </form>
                </div>
                    <div class="button-container">
                        <label for="fileInput" class="upload-label">Enviar Exame</label>
                        <input type="file" id="fileInput" accept=".pdf" style="display: none;">
                        <button type="submit" class="send-button" id="sendButton">Enviar</button>
                        <button class="archive-button" id="archiveButton">Arquivar</button>
                        <button id="clearChatButton" class="clear-chat-button">Limpar Chat</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <img src="{% static 'health_ai/img/img8.png' %}" class="logo">
    <script src="{% static 'health_ai/js/script.js' %}"></script>
</body>
</html>